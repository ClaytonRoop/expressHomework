<!DOCTYPE html>
<html lang="en-us">

<head>

    <meta charset="UTF-8">
    <title>Triva Game </title>

    <!-- Bootstrap CSS -->
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">

    <!-- <link rel="stylesheet" type="text/css" href="assets/css/reset.css"> -->

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

</head>

<body>
    <div class="container">

        <div class="page-header topHeader">
            <h1 class="headerText">
                Dating App
            </h1>
        </div>


        <div class="row mainPanelRow">
            <div class="col-sm-8 triviaPanel">
                <div class "panel-body triviaQuestions">
                    <div class="form-group">
                        <h3 class="question1">Please Enter Your Name</h3>
                        <label for="nameInput" class="col-2 col-form-label">Required</label>
                        <div class="col-10">
                            <input class="form-control" type="text" name="nameInput" id="nameInput">
                        </div>
                        <h3 class="question1">Link to Photo</h3>
                        <label for="photoInput" class="col-2 col-form-label">Required</label>
                        <div class="col-10">
                            <input class="form-control" type="text" name="photoInput" id="photoInput">
                        </div>
                    </div>
                    <form>
                        <div class="form-group">
                            <h3 class="question1">How much do you love the Ravens?</h3>
                            <label for="question1">Example select</label>
                            <select class="form-control" id="question1">
                                <option name="q1" value="1">1 </option>
                                <option name="q1" value="2">2</option>
                                <option name="q1" value="3">3</option>
                                <option name="q1" value="4">4</option>
                                <option name="q1" value="5">5</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <h3 class="question2">How would you rate this question?</h3>
                            <label for="question2">Example select</label>
                            <select class="form-control" id="question2">
                                <option name="q2" value="1">1</option>
                                <option name="q2" value="2">2</option>
                                <option name="q2" value="3">3</option>
                                <option name="q2" value="4">4</option>
                                <option name="q2" value="5">5</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <h3 class="question3">How would you rate this question?</h3>
                            <label for="question3">Example select</label>
                            <select class="form-control" id="question3">
                                <option name="q3" value="1">1</option>
                                <option name="q3" value="2">2</option>
                                <option name="q3" value="3">3</option>
                                <option name="q3" value="4">4</option>
                                <option name="q3" value="5">5</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <h3 class="question4">How would you rate this question?</h3>
                            <label for="question4">Example select</label>
                            <select class="form-control" id="question4">
                                <option name="q4" value="1">1</option>
                                <option name="q4" value="2">2</option>
                                <option name="q4" value="3">3</option>
                                <option name="q4" value="4">4</option>
                                <option name="q4" value="5">5</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <h3 class="question5">How would you rate this question?</h3>
                            <label for="question5">Example select</label>
                            <select class="form-control" id="question5">
                                <option name="q5" value="1">1</option>
                                <option name="q5" value="2">2</option>
                                <option name="q5" value="3">3</option>
                                <option name="q5" value="4">4</option>
                                <option name="q5" value="5">5</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <h3 class="question6">How would you rate this question?</h3>
                            <label for="question6">Example select</label>
                            <select class="form-control" id="question6">
                                <option name="q6" value="1">1</option>
                                <option name="q6" value="2">2</option>
                                <option name="q6" value="3">3</option>
                                <option name="q6" value="4">4</option>
                                <option name="q6" value="5">5</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <h3 class="question7">How would you rate this question?</h3>
                            <label for="question7">Example select</label>
                            <select class="form-control" id="question7">
                                <option name="q7" value="1">1</option>
                                <option name="q7" value="2">2</option>
                                <option name="q7" value="3">3</option>
                                <option name="q7" value="4">4</option>
                                <option name="q7" value="5">5</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <h3 class="question8">How would you rate this question?</h3>
                            <label for="question8">Example select</label>
                            <select class="form-control" id="question8">
                                <option name="q8" value="1">1</option>
                                <option name="q8" value="2">2</option>
                                <option name="q8" value="3">3</option>
                                <option name="q8" value="4">4</option>
                                <option name="q8" value="5">5</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <h3 class="question9">How would you rate this question?</h3>
                            <label for="question9">Example select</label>
                            <select class="form-control" id="question9">
                                <option name="q9" value="1">1</option>
                                <option name="q9" value="2">2</option>
                                <option name="q9" value="3">3</option>
                                <option name="q9" value="4">4</option>
                                <option name="q9" value="5">5</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <h3 class="question10">How would you rate this question?</h3>
                            <label for="question10">Example select</label>
                            <select class="form-control" id="question10">
                                <option name="q10" value="1">1</option>
                                <option name="q10" value="2">2</option>
                                <option name="q10" value="3">3</option>
                                <option name="q10" value="4">4</option>
                                <option name="q10" value="5">5</option>
                            </select>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    </div>
    </div>


    <div class="row startGameRow">
        <div class="col-sm-8 submitPanel">
            <div class="panel-body submit">
                <button class="btn btn-default submitButton">
                    <h1 class="submitText">Submit!</h1>
                </button>
            </div>
        </div>
    </div>


    </div>

    <footer class="footer">
        <div class="container">
            <p>
                <a href="/api/friends">API Friend's List</a> |
                <a href="https://github.com/afhaque/HotRestaurant">GitHub Repo</a>
            </p>
        </div>
    </footer>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Script -->
    <script type="text/javascript">

        $(".submitButton").on("click", function () {
            alert("Button Clicked");
            start();
        });

        function start() {

            var name = $("#nameInput").val().trim();
            var photo = $("#photoInput").val().trim();
            var scores = [];

            var answer1 = $("select#question1").val();
            var answer2 = $("select#question2").val();
            var answer3 = $("select#question3").val();
            var answer4 = $("select#question4").val();
            var answer5 = $("select#question5").val();
            var answer6 = $("select#question6").val();
            var answer7 = $("select#question7").val();
            var answer8 = $("select#question8").val();
            var answer9 = $("select#question9").val();
            var answer10 = $("select#question10").val();

            scores.push(answer1, answer2, answer3, answer4, answer5, answer6, answer7, answer8, answer9, answer10);

            console.log(scores);

            var newUser = {
                name: name,
                photo: photo,
                scores: scores,
            };
            console.log(newUser);
            startMatch(newUser);
            postApi(newUser)
        }


        function startMatch(newUser) {
            $.get("/api/friends", function (data) {
                var chosen = data;
                alert("something happened");
                console.log("chosen" + JSON.stringify(chosen));
                console.log("newUser " + newUser);
                console.log(JSON.stringify(newUser));
                console.log(newUser.scores);
                var total = 0;
                var userLoop = newUser.scores
                for (var i = 0; i < userLoop.length; i++) {
                    console.log("userLoop= " + userLoop[i]);
                    var parsed = parseInt(userLoop[i]);
                    total += parsed;
                }
                console.log("total" + total);
                findMatch(total, chosen);

            });
        }

        function findMatch(total, chosen) {
            var friendObject = [];
            for (i = 0; i < chosen.length; i++) {
                var dataLoop = chosen[i].scores
                var friendName = chosen[i].name;
                var friendTotal = 0;
                for (j = 0; j < dataLoop.length; j++) {
                    console.log("dataLoop " + dataLoop[j]);
                    var dataParsed = parseInt(dataLoop[j]);
                    friendTotal += dataParsed
                    var difference = total - friendTotal;
                    difference = Math.abs(difference);
                    console.log("difference: " + difference);
                }
                console.log("FriendTotal " + friendTotal);
                // friendObject.push(friendTotal);
                var object = { name: friendName, scores: friendTotal, difference: difference }
                friendObject.push(object);
                console.log(friendObject);

            }
            lastStep(friendObject, total)
        }

        function lastStep(friendObject, total) {
            for (i = 0; i < friendObject.length; i++) {
                console.log("name " + friendObject[i].name);
                console.log("difference " + friendObject[i].difference)
                if (friendObject[i].difference < 1) {
                    getMatch(friendObject[i].name)
                    console.log("you are at 1");
                    break
                }
                if (friendObject[i].difference < 2) {
                    getMatch(friendObject[i].name)
                    console.log("you are at 2");
                    break
                }
                if (friendObject[i].difference < 3) {
                    getMatch(friendObject[i].name)
                    console.log("you are at 3");
                    break
                }

                if (friendObject[i].difference < 4) {
                    getMatch(friendObject[i].name)
                    console.log("you are at 4");
                    break
                }

                if (friendObject[i].difference < 5) {
                    getMatch(friendObject[i].name)
                    break
                }
            }
            // alert("no matches for your ugly ass");
        }

        function getMatch(name) {
            console.log("getMatch name " + name);
            $.get("/api/friends", function (data) {
                var chosen = data;
                for (i = 0; i < chosen.length; i++) {
                    console.log("getMatch chosen[i].name = " + chosen[i].name);
                    if (chosen[i].name == name) {
                        alert("your match is " + chosen[i].name + "  Photolink: " + chosen[i].photo);

                    }
                }
            })
        };

        function postApi(newUser) {
            $.post("/api/friends", newUser,
                function (data) {

                    // If a table is available... tell user they are booked.
                    if (data) {
                        alert("You've been added to the API as well")
                    }

                });

        }



        // // var newCharacter = {
        // //     name: $("#name").val().trim(),
        // //     role: $("#role").val().trim(),
        // //     age: $("#age").val().trim(),
        // //     forcePoints: $("#force-points").val().trim()
        // // };

        // // $.get("/api/reservations", function (data) {

        // //     console.log(data);
        // //     // Question: What does this code do??

        // // });

        //     // function getFriends(newUser) {
        //     //     $.get("/api/friends", function (data) {
        //     //         var chosen = data;
        //     //         alert("something happened");
        //     //         console.log(chosen);
        //     //     });

    </script>

</body>

</html>